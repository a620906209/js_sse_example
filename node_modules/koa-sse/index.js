
/**
 * Module dependencies.
 */

var sse = require('sse-stream');
var pipe = require('multipipe');

module.exports = function(){
  return function*(next){
    this.sse = function(stream, opts){
      this.set('Content-Type', 'text/event-stream');
      this.set('Cache-Control', 'no-cache');
      this.set('Connection', 'keep-alive');
      this.body = pipe(stream, sse(opts));
    };
    yield next;
  }
};
